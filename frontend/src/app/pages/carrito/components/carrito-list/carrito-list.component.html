<p-toast></p-toast>

<div class="max-w-4xl mx-auto p-4 bg-white rounded-2xl shadow-md mt-6">
  <h1 class="text-2xl font-semibold mb-4 text-center font-italic">Carrito</h1>

  @if(spinner){
  <div class="flex justify-center items-center py-10">
    <p-progressSpinner></p-progressSpinner>
  </div>
  }@else if( !spinner && productos && productos.length === 0){
  <p class="sin-productos text-gray-500 text-center">
    No hay productos en el carrito.
  </p>
  } @else{

  <div class="grid gap-4">
    <div class="col-12 md:col-8">
      <p-table
        [value]="productos"
        responsiveLayout="scroll"
        class="tabla-carrito"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>Producto</th>
            <th>Imagen</th>
            <th>Cantidad</th>
            <th>Precio</th>
            <th>Subtotal</th>
            <th>Eliminar</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-item>
          <tr>
            <td>{{ item.nombre }}</td>
            <td>
              <img
                [src]="item.imagen"
                alt="{{ item.nombre }}"
                class="img-producto"
              />
            </td>
            <td>{{ item.cantidad }}</td>
            <td>${{ item.precio }}</td>
            <td>${{ item.precio * item.cantidad }}</td>
            <td>
              <button
                pButton
                icon="pi pi-trash"
                class="p-button-rounded p-button-danger p-button-sm boton-eliminar"
                (click)="eliminarProducto(item.id_item)"
                aria-label="Eliminar producto"
                title="Eliminar producto"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>

    <div class="col-12 md:col-4">
      <p-card header="Resumen de Compra" class="card-resumen">
        <div class="total-carrito mb-3">Total: ${{ total }}</div>
        <div class="botones-resumen">
          <button
            pButton
            label="Finalizar Compra"
            icon="pi pi-credit-card"
            class="p-button-success w-full mb-2 boton-comprar"
            aria-label="Finalizar Compra"
            title="Finalizar Compra"
          ></button>

          <button
            pButton
            label="Vaciar Carrito"
            icon="pi pi-trash"
            class="p-button-danger w-full boton-vaciar"
            (click)="vaciarCarrito()"
            aria-label="Vaciar Carrito"
            title="Vaciar Carrito"
          ></button>
        </div>
      </p-card>
    </div>
  </div>

  }
</div>
